### 네트워크 계층
- 송수신 호스트 사이의 패킷 전달 경로를 선택
- 라우팅 과정에서 일어나는 문제 처리도 담당
- 혼잡 제어, 패킷 분할과 병합 담당

### 네트워크 계층 주요 기능
- 라우팅: 라우팅 테이블에 네트워크 구성에 대한 정보 보관, 패킷 전송 경로 선택
- 혼잡 제어: 네트워크에 패킷 수가 과도하게 증가하는 혼잡 현상을 제어
- 패킷 분할과 병합: 상위 전송 계층에서 송신을 요구한 데이터는 최종적으로 MAC 계층의 프레임 구조에 정의된 형식으로 캡슐화 되어 전송. 이 때 데이터가 너무 크면 여러 개의 패킷으로 작게 쪼개 전송. 분할된 패킷을 다시 모으는 과정을 병합

### 비연결형 서비스
- 패킷의 전달 순서, 패킷 분실 여부 등에서 신뢰성이 떨어짐
- 자체적인 오류 제어와 흐름 제어를 더 많이 수행
- 전송 계층에서 수신한 패킷 순서 재조립하는 과정이 필요
- IP 프로토콜과 UDP가 이런 방식으로 동작

### 연결형 서비스
- 신뢰성이 높은 서비스
- 패킷들이 모두 동일한 경로를 이용하기 때문에 패킷들의 순서가 유지됨

### 라우팅
- 정적 라우팅: 경로 정보를 라우터에 미리 저장, 네트워크 변화에 대응 불가
- 동적 라우팅: 네트워크 상황에 따라 적절하게 변경

### HELLO/ECHO 패킷
- 이웃 라우터의 경로 정보를 파악하는 것
- 연결된 라우터에 초기화를 위한 HELLO 패킷을 전송해서 경로 정보를 얻음
- 전송 지연 시간 측정을 위해선 ECHO 패킷을 전송

### 라우팅 테이블
- (목적지 호스트, 다음 홉)으로 각각의 라우터마다 테이블을 보관하도록 한다.

### 라우팅 정보의 처리
- 라우팅 정보가 네트워크의 현재 상황을 정확히 반영할 수 있도록 관리해야함
- 소스 라우팅: 호스트가 목적지 호스트까지 전달 경로를 스스로 결정하는 방식, 중간 라우터들은 라우팅 테이블 필요 x
- 분산 라우팅: 라우팅 정보가 분산되는 방식으로 데이터그램 방식에서 많이 사용, 호스트 수가 많아질 수록 효과적
- 중앙 라우팅: RCC라는 중앙 호스트가 모든 전송 경로 관리, 호스트가 많아질 수록 효율 급감
- 계층 라우팅: 분산 라우팅과 중앙 라우팅 기능을 적절히 조합

### 혼잡 제어
- 흐름 제어는 송신 호스트와 수신 호스트 사이의 점대점 전송 속도를 다룬다.
- 혼잡 제어는 더 넓은 관점에서 호스트와 라우터를 포함한 서브넷에서 네트워크의 전송 능력 문제를 다룬다.
- 네트워크의 처리 능력보다 지나치게 많은 패킷이 입력되면 혼잡이 발생

### 혼잡의 원인
- 타임아웃으로 발생하는 패킷 재전송
- 패킷이 제대로 수신 되었는지 송신 호스트에 알려주는 응답 알고리즘
- 라우팅 알고리즘
- 생존 시간 (각 패킷별로 거쳐온 홉의 수를 카운팅, 일정 수 이상 증가하면 의미없이 네트워크를 떠도는 거라 판단하여 죽임)

### 트레픽 성형
- 송신 호스트가 전송하는 패킷의 발생 빈도가 네트워크에서 예측할 수 있는전송률로 이루어지게 하는 기능
- 리키 버킷: 깔대기의 형태를 가지며, 일정한 전송률을 출력한다.

### 혼잡 제거
- 혼잡이 사라질 때까지 연결 허용 안하기 -> 비효율
- 미리 대역을 할당해주어 혼잡 예방하기 -> 자원 낭비
- ECN 패킷의 사용. 라우터가 혼잡 발생 가능성이 예상될 경우 수신자에게 ECN 패킷 전송, 전송 속도 늦춤

### 단순 라우팅 프로토콜
- 최단 경로 라우팅: 가장 거리가 가까운 라우터로 연결, 이때 거리는 홉 수, 패킷 전송 진연 시간, 대역폭, 통신 비용이 될 수 있음.
- 플러딩: 가능한 모든 경로로 패킷을 전송.

### 거리 벡터 라우팅 프로토콜
- 자신과 직접 연결된 이웃 라우터와 라우팅 정보를 교환하는 방식
- 링크 벡터: 이웃 네트워크에 대한 연결 정보
- 거리 벡터: 개별 네트워크까지의 거리 정보
- 다음 홉 벡터: 개별 네트워크로 가기 위한 다음 홉 정보

### 링크 벡터
- 자신과 직접 연결된 이웃 네트워크에 대한 연결 정보
- 이웃 네트워크와 몇 번 포트를 사용하여 연결되었는 지를 나타냄

### 거리 벡터
- 특정 라우터에서 개별 네트워크들까지의 거리 정보를 관리
- 전체 네트워크에 소속된 네트워크 개수 만큼 거리 값을 관리

### 다음 홉 벡터
- 개별 네트워크까지 패킷을전송하는 경로에 있는 다음 홉 정보를 관리한다.

### RIP 프로토콜
- 거리 벡터를 사용하는 내부 라우팅 프로토콜 중에 가장 간단히 구현된 것이며 현재 많이 사용
- 이웃 라우터가 제공하는 거리 벡터 정보가 짧은 시간 내에 도착해야하지만 이것이 쉽지 않음
- UDP 프로토콜을 이용, 개별 거리 정보를 테이블에 순차적으로 적용되도록 함
- 새로운 목적지나 기존 거리벡터보다 지연이 적으면 라우팅 테이블에 반영

### 링크 상태 라우팅 프로토콜
- 개별 라우터가 이웃 라우터까지의 거리정보를 구한 후 이를 네트워크에 연결된 모든 라우터에 통보
- 플러딩 기법을 사용
- 이웃한 모든 라우터에 정보를 전달, 다시 라우터가 주변의 모든 라우터에 정보를 전달
- 링크 상태 방식 사용의 예시는 TCP/IP 기반의 인터넷에서 사용하는 OSPF가 있다.

### 외부 라우팅 프로토콜
- BGP(Borer Gateway Protocol)를 많이 사용함.
- 이와같은 라우터를 게이트웨이라고 함

### IP 프로토콜
- 호스트 주소 표기, 패킷 분할 지원
- end to end 형식의 오류 제어나 흐름 제어 기능 제공하지 않음
- 수신 호스트에 100% 도착하는 것을 보장하지 않음
- 비 연결형 서비스 제공
- 패킷 분할 병합 기능을 수행하기도 함
- 데이터 체크섬은 제공하지 않고 헤더 체크섬만 제공

### DHCP 프로토콜
- 호스트에 IP를 할당하는 프로토콜
- IP 풀을 만들어놓고 요청이 오면 이 풀에서 꺼내어 할당해주는 방식
