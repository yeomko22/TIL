## 3부 구조 패턴
### 14장 초기화 컨테이너
- 초기화 로직을 애플리케이션 컨테이너에서 분리하여 컨테이너가 단일 목적을 유지할 수 있도록 함
- 초기화 컨테이너는 순차적으로 실행, 모든 초기화 작업이 완료되기 전까지 애플리케이션 컨테이너들은 대기
- 애플리케이션 컨테이너들은 병렬적으로 실행
- 초기화 컨테이너 중 가장 많은 리소스 요구량과 애플리케이션 컨테이너 전체의 리소스 요구량 중 큰 값을 해당 파드의 리소스 요구량으로 취급

### 그외 초기화 방법
- 어드미션 컨트롤러
- 어드미션 웹 훅
- 이니셜라이저
- 파드프리세트

### 15장 사이드카 패턴
- 사이드카는 기존 컨테이너의 변경 없이 기능을 확장하고 향상시킴
- 단일 목적 컨테이너들이 서로 긴밀하게 협력할 수 있게 해주는 기본 컨테이너 패턴 중 하나
- 어댑터와 앰버서더는 사이드카 패턴 중 특수 케이스
- 바람직한 컨테이너는 마치 하나의 리눅스 프로세스 처럼 동작해야 한다.
- 쉽게 교체할 수 있고 재사용이 가능해야 한다.

### 사이드카 컨테이너
- 동일 파드 내 컨테이너는 다음과 같은 요소들을 공유
  - 볼륨 스토리지
  - 동일 노드에 배치
  - 호스트 파드의 수명 주기
  - 호스트의 IPC를 통해서 통신 가능
  - IP 공유
- 사이드카 컨테이너는 크기가 작으며 최소한의 자원을 사용해야 함
- 네트워킹, 모니터링, 트레이싱 등을 처리하는데 사용된다.

### 16장 어댑터
- MSA에서 각 컴포넌트들은 이질적인 특성을 지닌다. (ex. 개발 언어, 사용 프레임워크 등)
- 하지만 클러스터 단위로 통일된 방식으로 수행하고 싶은 작업이 있을 수 있으며, 이 때 문제가 발생한다.
- 모니터링을 위해 메트릭을 수집하는 것이 대표적인 사례이다.
- 어댑터 컨테이너를 통해 메트릭을 하나의 표준 형식 및 프로토콜로 내보내으로써 모니터링 인터페이스를 제공할 수 있다.
- 사용자 정의 애플리케이션 별로 메트릭을 읽어서 모니터링 도구가 이해할 수 있는 형식으로 노출하는 별도의 컴포넌트를 파드 내에 배포한다.
- 프로메테우스 어댑터를 배포하면 기본 애플리케이션은 프로메테우스에 대해서 몰라도 프로메테우스의 모니터링을 사용 가능하다.
- 또다른 사용 예시로는 로깅이 있다. 로그를 중앙 에그리게이터로 수집 전에 형식을 통일하는 용도로 어댑터 패턴을 사용할 수 있다.

### 17장 엠버서더
- 파드 외부의 서비스에 접근하는 통합 인터페이스를 제공하는 사이드 카 패턴이다.
- 쿠버네티스에서 파드는 동적으로 변경되는 주소, 로드 밸런싱, 신뢰할 수 없는 프로토콜, 어려운 데이터 형식 등으로 여타 서비스에 신뢰할 수 있는 방법으로 도달하기 어려운 경우가 많다.
- 앰버서더 패턴은 외부에서 여러 서비스에 접근할 수 있도록 로직을 추상화하고 분리하는 것이다.
- 외부 서비스에 접근하기 위한 클라이언트 프로그램, 보안처리, 네트워크 설정 등을 별도의 컨테이너로 만들고, 이를 프록시로 삼아서 외부 서비스를 이용하게 된다.
- 이러한 프록시는 서킷 브레이커의 역할을 수행하기도 한다.
- istio가 이러한 패턴을 이용하여 서비스 매쉬를 구현한다.
- 즉, 외부 서비스 이용에 대한 책임과 세부 사하을 다른 특수 컨테이너에 위임할 수 있다.
