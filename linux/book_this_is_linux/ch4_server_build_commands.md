## 4장 서버 구축 시 알아야할 필수 개념과 명령어
### 시작과 종료
```bash
# 종료
$ poweroff
$ shutdown -P now # 지금 종료
$ shutdown -P +10 # 10분 뒤 종료

# 재부팅
$ reboot
$ shutdown -r
$ shutdown -r +10 # 10분 뒤 재부팅

#  기타
$ shutdown -c # 예약된 shutdown 명령어 취소
```

### 사용자 관리
- 현재 사용자 및 그룹 목록 확인 커맨드
```bash
$ cat /etc/passwd # 사용자 목록 확인
$ cat /etc/group # 그룹 목록 확인
```
- useradd/adduser: 레드햇 계열에서는 동일한 의미, 데비안 계열에서는 다른 의미
- 데비안에서 adduser 명령어로 사용자 계정을 추가하면 자동으로 홈 디렉터리 생성해주는 등 추가 기능 지원
- 사용자 생성 커맨드
```bash
$ useradd newuser
$ useradd -u 1111 newuser # 사용자 추가하면서 id를 1111로 지정
$ useradd -g mygroup newuser # 사용자 추가하면서 mygroup에 포함시킴
$ useradd -d /newhome newuser # 사용자 추가하면서 홈 디렉터리를 지젖ㅇ
```
- 그 외 사용자 관련 커맨드
```bash
$ passwd newuser # 사용자 패스워드 지정
$ usermod -g mygroup newuser # 사용자 그룹 변경
$ userdel -r newuser # 사용자 삭제하고 홈 디렉터리까지 삭제
$ groups newuser # 사용자가 속한 그룹 보여줌
$ groupadd newgroup # 그룹 생성
$ groupmod -n mygroup newgroup # 그룹의 속성 변경, 여기서는 이르므 변경
$ groupdel newgroup # 그룹 삭제
$ groupwd newgroup# 그룹 암호 설정 및 그룹 관리 수행
```

### 파일 권한
- -rw-r--r--: 이런식으로 7개의 글자로 표현, 파일 유형, 사용자 권한, 그룹 권한, 그 외 사용자 권한 의미
- 파일 유형에는 d(디렉터리), -(일반 파일), b(블록 디바이스), c(문자 디바이스), I(링크)가 있다.
- chown {사용자 이름} 파일 이름: 파일 소유자 변경
- chgrp {그룹이름} 파일 이름: 파일 소유 그룹 변경

### 링크
- inode: 리눅스 파일 시스템에서 사용하는 자료 구조로 파일의 메타 데이터를 저장
- hard link 생성하면 원본 파일의 inode를 공유하는 파일을 생성하는 것
- symbolic link를 생성하면 새로운 inode2를 생성하고 여기에 원본 파일의 포인터를 담는다.
```bash
$ ln {링크대상파일명} {링크파일명} # 하드 링크
$ ln -s {링크대상파일명} {링크파일명} # 소프트 링크
```

### RPM과 DNF
- RPM은 yum 이전의 패키지 매니저이다.
- RPM은 의존성 문제가 있었는데 이를 DNF가 해결했다.
- DNF는 RPM과 별도라기 보다는 RPM을 설치하는 편리한 도구이다.
- DNF는 centOS8부터 도입된 yum의 기능을 대폭 개선한 패키지 매니저이다.

### 패키지 저장소
- /etc/yum.repos.d/ 디렉터리 안에 파일들이 담겨져 있음
- 파일 안에는 저장소의 이름, url, 각종 설정 값들이 담겨져 있음
- dnf install {패키지 이름} 실행 방식
  - 1. 먼저 /etc/yum.repos.d 안의 파일들에서 저장소들의 url 목록을 가져옴
  - 2. 그 다음 원격 저장소들에서 다운로드 가능한 패키지들의 목록을 가져옴
  - 3. 패키지 목록에서 현재 설치하고자 하는 패키지와 관련된 패키지들의 주소만 추려냄
  - 4. 다운로드 해야할 패키지들을 원격 저장소에 요청
  - 5. 원격 저장소로부터 자동으로 다운로드 및 자동 설치 진행

### 파일 압축과 묶기
- 리눅스에서는 파일의 압축과 묶기가 별도로 구분되어 있다.
- 파일 묶기 작업은 tar 명령어를 통해서 수행하고, 압축은 압축 확장자 별로 명령어가 다르다.
- 이전에 사용했었던 tar xzf 이런 명령어는 사실 파일 묶기와 압축을 동시에 수행하는 명령어이다.

### 파일 압축 명령어
- xz: 최신  압축 명령, 압축률이 뛰어남
  - xz <파일 이름>: 파일 이름.xz 생성 후 기존 파일 삭제
  - xz -d <압축 파일 이름>: 압축 파일의 압축 해제
  - xz -k <파일 이름>: 압축 파일 생성 후 기존 파일 그대로 둠
- gzip: gz 확장자로 압축하거나 풀어줌
  - gzip <파일이름>
  - gzip -d <압축 파일 이름>
- zip, unzip: windows와 호환 가능한 압축 파일 형식 zip으로 압축 혹은 해제

### 파일 묶기
- tar: tar 로 묶음 파일을 만들거나 풀어줌. 즉 파일들을 하나로 묶은 다음 압축하는 것
  - c: 새로운 묶음을 만듦
  - x: 묶은 파일 풀어줌
  - t: 묶음 풀기 전에 묶인 경로 보여줌
  - C: 묶음 풀때 지정된 디렉터리에 풀어줌
  - f: 묶음 파일 이름 지정
  - v: 파일이 묶이거나 풀리는 과정을 보여줌
  - J: tar + xz
  - z: tar + gzip
- 예시
  - tar cvf my.tar /etc/sysconfig/  # 단순 묶기
  - tar cvfJ my.tar.xz /etc/sysconfig/  # 묶기 + xz 압축
  - tar cvfz my.tar.gz /etc/sysconfig/  # 묶기 + gzip 압축
  - tar xvf my.tar # tar 파일 압축 풀기
  - tar cxvf newdir my.tar # 새 폴더에 tar 풀기
  - tar xfJ my.tar.xz # xz 압축 해제 + tar 풀기
  - tar xfz my.tar.gz # gzip 압축 해제 + tar 풀기

### 파일 위치 검색
- find 경로 옵션 조건 action: 특정 디렉터리 안의 조건에 맞는 파일 검색
- which <파일 이름>: 환경변수 PATH에 설정된 디렉터리 검색
- whereis <파일 이름>: 실행 파일 및 소스, man 페이지 파일까지 검색
- locate <파일 이름>: 파일 목록 데이터 베이스 검색, 가장 범용적으로 사용이 가능, 단 추가 라이브러리 설치가 필요하며 디비 구성에 시간이 좀 걸림

### CROR과 at
- CRON: 주기적으로 실행해야할 작업 설정
- at: 1회성 작업 설정

### 네트워크 관련 명령어
- nmtui: 네트워크 관련 작업 가능
  - 자동 IP 주소, 고정 IP 주소 사용 결정
  - IP 주소, 서브넷 마스크, 게이트웨이 정보 입력
  - DNS 정보 입력
  - 네트워크 카드 드라이버 설정
  - 네트워크 장치 설정
- systemctl start/stop/status NetworkManager
  - 네트워크 설정 변경 후 변경된 내용을 시스템에 적용시키는 명령어
- ipup <장치 이름> / ipdown <장치 이름> / ifconfig <장치 이름>
  - 네트워크 장비를 켜고 끄는 명령어
- nslookup
  - DNS 서버의 작동을 테스트하는 명령어

### 네트워크 설정과 관련된 주요 파일
- /etc/sysconfig/network: 네트워크의 기본 정보가 설정되어 있는 파일, 네트워크 사용 여부 기재
- /etc/sysconfig/network-scripts/ifcfg-ens160: 네트워크 장비 설정 정보 담겨있는 파일
- /etc/resolv.conf: DNS 서버의 정보와 호스트 이름이 들어 있는 파일
- /etc/hosts: 현재 컴퓨터의 호스트 이름과 FQDN이 들어있는 파일

### 프로세스, 데몬, 서비스
- 프로세스: 하드 디스크에 저장된 실행 코드가 메모리에 로딩되어 활성화 된 것
- 포그라운드 프로세스: 사용자와 상호작용하는 프로세스
- 백그라운드 프로세스: 백단에서 동작하는 프로세스
- 예제
```bash
$ yes > /dev/null # 무한 루프 프로세스 생성
$ ctrl + z # 프로세스 일시 정지
$ bg # 백그라운드 프로세스로 전환
$ jobs # 백그라운드 프로세스 목록 확인
$ fg <작업 번호> # 백그라운드 프로세스의 포그라운드 전환
```

### 서비스
- 데몬이라 부른느 서비스는 서버 프로세스를 지칭
- 웹 서버, 네임 서버, DB 서버 등의 프로세스를 지칭
- 눈에 보이지 않지만 현재 시스템에서 동작 중인 프로세스로 백그라운드 프로세스의 일종

### 서비스와 소켓
- 서비스는 평상시에도 늘 가동하는 서버 프로세스이며 소켓은 필요할 때만 동작하는 서버 프로세스
- 이 둘은 systemd라는 서비스 매니저 프로그래믕로 작동시키거나 관리
